<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‚öúÔ∏è The Grand Tournament of Flip VII ‚öúÔ∏è</title>

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">

<style>

body {
    margin: 0;
    font-family: 'Cinzel', serif;
    text-align: center;
    background: linear-gradient(
        135deg,
        #4b0000 0%,
        #7a0000 40%,
        #a30000 70%,
        #c40000 100%
    );
    background-attachment: fixed;
    color: #f4e4c1;
}

/* Header plaque */
.header {
    background: linear-gradient(
        135deg,
        #b34700,
        #d2691e,
        #ff8c00
    );
    padding: 25px;
    margin: 30px auto;
    width: 90%;
    max-width: 1000px;
    border-radius: 15px;
    box-shadow: 0 12px 35px rgba(0,0,0,0.5);
}

.header h1 {
    color: #ffd700;
    margin: 0;
    font-size: 2.6rem;
    text-shadow: 2px 2px 8px rgba(0,0,0,0.8);
}

.banner {
    margin-top: 15px;
    font-size: 1.3rem;
    color: #f4e4c1;
    text-shadow: 1px 1px 6px rgba(0,0,0,0.7);
}

/* Card container */
.container {
    width: 95%;
    max-width: 1100px;
    margin: 30px auto;
}

/* Player cards */
.card {
    background: #f4e4c1;
    margin: 15px auto;
    padding: 20px;
    border-radius: 12px;
    width: 85%;
    box-shadow: 0 6px 20px rgba(0,0,0,0.5);
    transition: 0.3s;
}

.card:hover {
    transform: scale(1.02);
}

/* Throne holder */
.throne {
    border: 3px solid gold;
    box-shadow: 0 0 25px gold;
    transform: scale(1.05);
}

/* God tier glow */
.goldGlow {
    box-shadow: 0 0 20px gold;
}

/* 2000+ cosmic glow */
.cosmicGlow {
    box-shadow: 0 0 25px #ffd700, 0 0 40px #a855f7;
}

.player-name {
    font-size: 1.6rem;
}

.score {
    font-size: 1.8rem;
    margin-top: 8px;
}

.title {
    font-size: 1.2rem;
    margin-top: 8px;
}

.refresh {
    margin-top: 20px;
    font-size: 0.9rem;
    color: #5a3b17;
}

</style>
</head>
<body>

<div class="header">
    <h1>‚öúÔ∏è The Grand Tournament of Flip VII ‚öúÔ∏è</h1>
    <div class="banner" id="banner"></div>
</div>

<div class="container" id="leaderboard"></div>

<div class="refresh">
Auto-refreshing every 30 seconds‚Ä¶
</div>

<script>

const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ5cF1uw15BXEj_czuBu979BQ_mQUlHBsiEj17VyyKyTscrPwz8OLK4wgyvkVle7otZnBRHTISUSxY5/pub?output=csv";

/* Title Logic */
function getTitle(score) {
    if (score >= 2000) return "üåå The Eternal Architect of Destiny";
    if (score >= 1400) return "üëë God of Fortune, Bringer of Sevens";
    if (score >= 1000) return "Sovereign of the Seven";
    if (score >= 800) return "Grandmaster";
    if (score >= 600) return "Warlord";
    if (score >= 400) return "Knight of Flip VII";
    if (score >= 200) return "Squire";
    return "Peasant of the Realm";
}

async function loadLeaderboard() {
    const response = await fetch(SHEET_URL);
    const data = await response.text();

    const rows = data.trim().split("\n").slice(1);
    const players = {};

    rows.forEach(row => {
        const cols = row.split(",");
        const name = cols[1]?.trim();
        const score = parseInt(cols[2]);

        if (!name || isNaN(score)) return;

        if (!players[name]) players[name] = 0;
        players[name] += score;
    });

    const leaderboard = Object.entries(players)
        .map(([name, total]) => ({ name, total }))
        .sort((a, b) => b.total - a.total);

    const container = document.getElementById("leaderboard");
    const banner = document.getElementById("banner");
    container.innerHTML = "";

    let throneHolder = null;

    const gods = leaderboard.filter(p => p.total >= 1400);

    if (gods.length > 0) {
        throneHolder = gods.sort((a,b)=>b.total-a.total)[0];
        banner.innerHTML = `‚öúÔ∏è SUPREME DIVINE THRONE HOLDER ‚öúÔ∏è<br>üëë ${throneHolder.name}`;
    } else if (leaderboard.length > 0) {
        banner.innerHTML = `‚öîÔ∏è Highest in the Realm: ${leaderboard[0].name}`;
    } else {
        banner.innerHTML = "Awaiting warriors...";
    }

    leaderboard.forEach(player => {
        const card = document.createElement("div");
        card.classList.add("card");

        const title = getTitle(player.total);

        if (player.total >= 1400) card.classList.add("goldGlow");
        if (player.total >= 2000) card.classList.add("cosmicGlow");
        if (throneHolder && throneHolder.name === player.name) {
            card.classList.add("throne");
        }

        card.innerHTML = `
            <div class="player-name">${player.name}</div>
            <div class="score">${player.total} Points</div>
            <div class="title">${title}</div>
        `;

        container.appendChild(card);
    });
}

loadLeaderboard();
setInterval(loadLeaderboard, 30000);

</script>

</body>
</html>